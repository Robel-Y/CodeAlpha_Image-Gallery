/* --- Base Styles & Variables --- */
:root {
    --bg-color-light: #f0f2f5; --card-color-light: #ffffff; --text-color-light: #333;
    --primary-color-light: #6a5af9; --secondary-color-light: #d8d5e2; --shadow-light: 0 8px 25px rgba(0, 0, 0, 0.1);
    --danger-color: #e74c3c; --danger-hover: #c0392b;
    --bg-color-dark: #121212; --card-color-dark: #1e1e1e; --text-color-dark: #e0e0e0;
    --primary-color-dark: #8a7dfc; --secondary-color-dark: #3a3a3a; --shadow-dark: 0 8px 25px rgba(0, 0, 0, 0.4);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; transition: background-color 0.4s, color 0.4s; }
body[data-theme='light'] { background-color: var(--bg-color-light); color: var(--text-color-light); }
body[data-theme='dark'] { background-color: var(--bg-color-dark); color: var(--text-color-dark); }
.hidden { display: none !important; }

/* --- Splash Screen & Toast --- */
#splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--primary-color-light); color: white; display: flex; justify-content: center; align-items: center; z-index: 1000; transition: opacity 1s ease-out, visibility 1s ease-out; }
#splash-screen.fade-out { opacity: 0; visibility: hidden; }
.splash-content i { animation: pulse 2s infinite; } @keyframes pulse { 50% { transform: scale(1.1); } }
.toast { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(100px); background-color: var(--primary-color-light); color: white; padding: 1rem 2rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); z-index: 1001; opacity: 0; visibility: hidden; transition: all 0.5s ease-out; }
.toast.show { transform: translateX(-50%) translateY(0); opacity: 1; visibility: visible; }
body[data-theme='dark'] .toast { background-color: var(--primary-color-dark); }

/* --- Main Layout & Player --- */
.player-container { display: flex; flex-direction: column; gap: 2rem; padding: 2rem; max-width: 600px; width: 100%; }
.player, .upload-section { background-color: var(--card-color-light); border-radius: 20px; padding: 2rem; box-shadow: var(--shadow-light); transition: all 0.4s; }
.player { text-align: center; }
.song-info { margin: 1.5rem 0; min-height: 60px; }
#song-title { font-size: 1.8rem; margin-bottom: 0.5rem; }

/* --- Visualizer --- */
.visualizer-container { display: flex; justify-content: center; align-items: flex-end; height: 60px; gap: 4px; margin-bottom: 1.5rem; }
.visualizer-bar { width: 8px; background-color: var(--primary-color-light); border-radius: 4px; transition: height 0.2s ease-out; height: 5px; }
.player.playing .visualizer-bar { animation: bounce 1.2s ease-in-out infinite alternate; }
@keyframes bounce { 100% { height: 60px; } }

/* --- Progress & Time --- */
.progress-container { width: 100%; height: 6px; background-color: var(--secondary-color-light); border-radius: 3px; cursor: pointer; margin-bottom: 5px; }
.progress-bar { width: 0%; height: 100%; background-color: var(--primary-color-light); border-radius: 3px; transition: width 0.1s linear; }
.time-display { display: flex; justify-content: space-between; width: 100%; font-size: 0.8rem; }

/* --- Controls --- */
.controls { display: flex; justify-content: center; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
.control-btn { border: none; background-color: transparent; color: #555; font-size: 1.5rem; cursor: pointer; border-radius: 50%; width: 55px; height: 55px; display: flex; justify-content: center; align-items: center; transition: all 0.3s ease; }
.play-btn { width: 75px; height: 75px; font-size: 2rem; background-color: var(--primary-color-light); color: white; }
.secondary-controls { display: flex; justify-content: center; align-items: center; gap: 1rem; width: 100%; }
.small-btn { width: 45px; height: 45px; font-size: 1rem; }
.small-btn.active { color: var(--primary-color-light); background-color: var(--secondary-color-light); }

/* --- Hover Menus (Volume, Speed, Playlist) --- */
.hover-menu-container { position: relative; }
.hover-menu-panel { position: absolute; bottom: 120%; left: 50%; visibility: hidden; opacity: 0; transition: all 0.3s; transform: translateX(-50%) translateY(10px); background-color: var(--card-color-light); border-radius: 10px; box-shadow: var(--shadow-light); padding: 0.5rem; }
.hover-menu-container:hover .hover-menu-panel { visibility: visible; opacity: 1; transform: translateX(-50%) translateY(0); }
.volume-slider { width: 100px; }
.slider { -webkit-appearance: none; height: 5px; border-radius: 5px; background: var(--secondary-color-light); outline: none; }
.slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 15px; height: 15px; border-radius: 50%; background: var(--primary-color-light); cursor: pointer; }
.speed-options ul, .playlist-options ul { list-style: none; padding: 0; margin: 0; }
.speed-options li, .playlist-options li { padding: 0.75rem 1.5rem; cursor: pointer; transition: background-color 0.2s; font-weight: bold; border-radius: 5px; white-space: nowrap; }
.speed-options li i, .playlist-options li i { margin-right: 0.75rem; }
.speed-options li.active { color: var(--primary-color-light); }
.playlist-options { padding: 0.5rem; }

/* --- Dynamic Upload Section --- */
.upload-section.has-content .drop-zone { border-style: solid; padding: 1rem; cursor: pointer; }
.upload-section.has-content .drop-zone p, .upload-section.has-content .drop-zone .file-label { display: none; }
.upload-section.has-content .drop-zone::before { font-family: "Font Awesome 6 Free"; font-weight: 900; content: "\f067"; font-size: 2rem; color: var(--primary-color-light); }
.drop-zone { border: 2px dashed var(--secondary-color-light); border-radius: 10px; padding: 2rem; text-align: center; color: #aaa; transition: all 0.3s; }
.drop-zone.dragover { border-color: var(--primary-color-light); transform: scale(1.02); }
#file-input { display: none; }
.file-label { display: inline-block; padding: 0.7rem 1.2rem; background-color: var(--primary-color-light); color: white; border-radius: 5px; cursor: pointer; margin-top: 1rem; }

/* --- Playlist Modal --- */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100; display: none; justify-content: center; align-items: center; }
.modal-overlay.show-modal { display: flex; }
.modal-content { background: var(--card-color-light); border-radius: 15px; padding: 1.5rem; width: 95%; max-width: 800px; max-height: 80vh; display: flex; flex-direction: column; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 1rem; margin-bottom: 1rem; border-bottom: 1px solid var(--secondary-color-light); }
.close-btn { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #888; }
.playlist-manager-body { display: flex; gap: 1.5rem; flex-grow: 1; min-height: 0; }
.playlist-list-panel { flex: 1; display: flex; flex-direction: column; border-right: 1px solid var(--secondary-color-light); padding-right: 1.5rem; }
.song-list-panel { flex: 2; display: flex; flex-direction: column; }
.playlist-list-panel h3, .song-list-header h3 { margin-bottom: 1rem; }
#playlist-list-container, #song-list-container { list-style: none; overflow-y: auto; flex-grow: 1; }
#playlist-list-container li { padding: 0.75rem; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; font-weight: 500; }
#playlist-list-container li.selected { background-color: var(--primary-color-light); color: white; font-weight: bold; }
#add-playlist-form { display: flex; gap: 0.5rem; margin-top: 0.5rem; }
#new-playlist-name { flex-grow: 1; padding: 0.5rem; border: 1px solid var(--secondary-color-light); border-radius: 5px; background: var(--bg-color-light); color: var(--text-color-light); }
.song-list-header { display: flex; justify-content: space-between; align-items: center; }
.playlist li { display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid var(--secondary-color-light); cursor: pointer; }
.playlist li.active { background-color: var(--secondary-color-light); font-weight: bold; }
.delete-song-btn { background: none; border: none; color: #aaa; cursor: pointer; font-size: 1rem; opacity: 0; transition: opacity 0.3s; }
.playlist li:hover .delete-song-btn { opacity: 1; }

/* --- General Buttons & Dark Theme --- */
.btn-primary { background-color: var(--primary-color-light); color: white; border: none; padding: 0.6rem 1rem; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; }
.btn-secondary { background-color: var(--secondary-color-light); color: var(--text-color-light); }
.btn-danger { background-color: var(--danger-color); color: white; border: none; padding: 0.6rem 1rem; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; }
.btn-danger:hover { background-color: var(--danger-hover); }
.btn-danger:disabled { background-color: #aaa; cursor: not-allowed; }
.full-width { width: 100%; }

body[data-theme='dark'] .player, body[data-theme='dark'] .upload-section, body[data-theme='dark'] .modal-content, body[data-theme='dark'] .hover-menu-panel { background-color: var(--card-color-dark); box-shadow: var(--shadow-dark); }
body[data-theme='dark'] .control-btn { color: #ccc; }
body[data-theme='dark'] .control-btn:hover { color: var(--primary-color-dark); background-color: var(--secondary-color-dark); }
body[data-theme='dark'] .small-btn.active { color: var(--primary-color-dark); background-color: var(--secondary-color-dark); }
body[data-theme='dark'] .visualizer-bar, body[data-theme='dark'] .progress-bar { background-color: var(--primary-color-dark); }
body[data-theme='dark'] .play-btn { background-color: var(--primary-color-dark); }
body[data-theme='dark'] .slider { background: var(--secondary-color-dark); }
body[data-theme='dark'] .slider::-webkit-slider-thumb { background: var(--primary-color-dark); }
body[data-theme='dark'] .speed-options li:hover, body[data-theme='dark'] .playlist-options li:hover { background-color: var(--secondary-color-dark); }
body[data-theme='dark'] .speed-options li.active { color: var(--primary-color-dark); }
body[data-theme='dark'] .upload-section.has-content .drop-zone::before { color: var(--primary-color-dark); }
body[data-theme='dark'] .modal-header, body[data-theme='dark'] .playlist li { border-color: var(--secondary-color-dark); }
body[data-theme='dark'] #new-playlist-name { background: var(--secondary-color-dark); color: var(--text-color-dark); border-color: #555; }
body[data-theme='dark'] #playlist-list-container li.selected { background-color: var(--primary-color-dark); }
body[data-theme='dark'] .playlist li.active { background-color: var(--secondary-color-dark); }
body[data-theme='dark'] .playlist-list-panel { border-color: var(--secondary-color-dark); }

/* --- Responsive Design for Modal --- */
@media (max-width: 768px) {
    .playlist-manager-body {
        flex-direction: column;
    }
    .playlist-list-panel {
        border-right: none;
        border-bottom: 1px solid var(--secondary-color-light);
        padding-right: 0;
        padding-bottom: 1.5rem;
    }
    body[data-theme='dark'] .playlist-list-panel {
        border-color: var(--secondary-color-dark);
    }
}